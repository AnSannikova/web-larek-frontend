# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## **Архитектура**

Описание классов, их предназначение и функции.

![UML.png](./UML.png)

### Базовый код

- **Класс `EventEmitter`**
    
    Класс обеспечивает работу событий. Его функции: возможность установить и снять слушателей событий, вызвать слушателей при возникновении события.
    
    Методы:
    
    `on` — для подписки на событие;
    
    `off` — для подписки на событие;
    
    `emit`  — для уведомления подписчиков о наступлении события соответственно;
    
    `onAll` — для сброса всех подписчиков;
    
    `trigger` — генерирующий заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса  EventEmitter.
    
- **Класс `Api`**
    
    Класс отправляет запросы на сервер. Имеет возможность сделать GET и POST - запросы, а также имеет метод для обработки данных в формат json в ответе от сервера или вывода ошибки при неудачном запросе.
    
    Методы:
    
    `handleResponse` — для обработки ответа от сервера: либо преобразует его в формат json, либо формирует ошибку;
    
    `get` — отправляет GET - запрос;
    
    `post` — отправляет POST - запрос.
    
- **Класс `Model<T>`**
    
    Абстрактный класс служит средством для хранения данных поступающих с сервера. Принимает в конструктор экземпляр класса `EventEmitter`, благодаря чему реализует метод для уведомления изменения модели и передачи подписчикам измененных данных. Класс является дженериком и принимает в переменной `T` тип и состав данных, какие мы хотим получить на вход.
    
    Методы:
    
    `emitChanges` — сообщить об изменении данных в модели.
    
- **Класс `Component<T>`**
    
    Абстрактный класс базового компонента представляет собой инструментарий для работы с DOM-элементом. Класс является дженериком и принимает в переменной `T` тип и состав данных, какие мы хотим получить на вход
    
    Методы:
    
    `setText` — установить текстовое содержимое;
    
    `setImage` — установить изображение;
    
    `toggleClass` — переключает класс;
    
    `setDisabled` — переключить статус блокировки элемента;
    
    `render` — принимает объект с данными и возвращает готовый DOM-элемент с этими данными.
    

### Общие переиспользуемые блоки:

- **Класс `Modal`**
    
    Класс реализующий вид и функционал модального окна. Наследуется от класса `Component`
    
    Методы:
    
    `content` — устанавливает контент внутри модального окна;
    
    `open` — открывает модальное окно;
    
    `close` — закрывает модальное окно;
    
    `render` — принимает объект с данными и возвращает готовый DOM-элемент с этими данными;
    
- **Класс `Form<T>`**
    
    Общий класс для работы с формами. Наследуется от класса `Component`. Отвечает за установку ошибок при заполнении формы, блокировку кнопки сабмита, если форма не валидна, и отрисовку самой формы. Класс является дженериком и принимает в переменной `T` тип и состав данных, какие мы хотим получить на вход
    
    Методы:
    
    `errors` — устанавливает ошибки при отсутствии заполненных полей;
    
    `validate` — отвечает за валидацию формы и блокировку кнопки сабмита;
    
    `render` — принимает объект с данными и возвращает готовый DOM-элемент с этими данными.
    

### Компоненты:

- **Класс `ProductItem`**
    
    Модель для хранения данных о продуктах и в дальнейшем их преобразований при необходимости. Наследуется от класса `Model`.
    
    Методы:
    
    `inBasket` — отвечает за состояние элемента, находится ли он в корзине или нет.
    
- **Класс `AppSate`**
    
    Класс для работы с состояниями приложения. Наследуется от класса `Model`. Хранит в себе информацию о состоянии корзины, элементов заказа, а также о продуктах.
    
    Методы:
    
    `setProducts` — установить внутри класса данные о продуктах;
    
    `getProducts` — получить данные о продуктах;
    
    `getBasketItems` — получить данные продуктов в корзине;
    
    `getTotal` — получить общую сумму стоимость товаров в корзине;
    
    `clearBasket` — очистить корзину;
    
    `setOrder` — установить значения полей для формирования заказа;
    
    `getOrder` — получить заполенную форму заказа
    
- **Класс** **`ApiShop`**
    
    Класс упрощает работу c сервером и приводит данные в ответе к удобному виду. Наследуется от класса `Api.`
    
    Методы:
    
    `getItemList` — получить список продуктов и их данные;
    
    `getItem` — получить подробную информацию об одном товаре через его идентификатор;
    
    `orderProducts` — отправить заказ и получить ответ от сервера об успешной отправке в виде идентификатора заказа и общей стоимости;
    
- **Класс `Page`**
    
    Класс отвечает за отображение счетчика корзины и блокировку страницы при открытии модального окна. При нажатии на иконку корзины формируется соответствующее событие об открытии корзины и открывается модальное окно. Наследуется от класса `Component`.
    
    Методы:
    
    `counter` — установить значение счетчика;
    
    `locked` — отвечает за блокировку прокрутки страницы, можно указать значения true или false.
    
- **Класс `Gallery`**
    
    Наследуется от класса `Component`. Представляет собой коллекцию элементов-кнопок, реализованных классом `Card`. При нажатии на элемент-кнопку формируется сообщение о событии открытия карточки, в обработчике события происходит запрос на сервер через метод `getItem` класса `ApiShop` и открывается модальное окно с пришедшей подробной информацией о товаре.
    
    Методы:
    
    `items` — установить элементы галереи;
    
- **Класс `Card`**
    
    Наследуется от класса `Component`. Отвечает за отображение карточки товара. Если в карточке предусматривается кнопка, по нажатию на нее формируется соответствующее событие: либо добавление в корзину, если это карточка просмотра подробной информации о товаре, либо удаление товара, если это карточка в корзине.
    
    Методы:
    
    `category` — установить значение категории товара;
    
    `title` — установить значение заголовка товара;
    
    `image` — установить значение картинки товара;
    
    `descripton` — установить значение описания товара;
    
    `price` — установить значение стоимости товара;
    
- **Класс `CardBasket`**
    
    Наследуется от класса `**Card`.** Отвечает за отображение карточки в корзине. К реализации основного класса добавляется метод установки порядкового номера товара в корзине.
    
    Методы:
    
    `index` — установить значение порядкового номера товара.
    
- **Класс `Basket`**
    
    Наследуется от класса `Component`. Отвечает за отображение товаров в корзине и общей суммы заказа. При клике на кнопку формируется соответствующее событие об открытии формы заказа.
    
    Методы:
    
    `items` — установить элементы корзины;
    
    `total` — установить значение общей суммы покупки;
    
- **Класс `Order`**
    
    Наследуется от класса **`Form<T>`.** Отвечает за отображение и валидацию формы заказа. При незаполненной форме кнопка сабмита не активна. При нажатии на кнопку  формируется соответствующее событие об открытии формы контактов.
    
    Методы: 
    
    `address` — установить значение поля адрес;
    
    `validate` — переопределяет родительский метод валидации формы.
    
- **Класс `Contacts`**
    
    Наследуется от класса **`Form<T>`.** Отвечает за отображение формы контактов. При нажатии на кнопку сабмита формируется соответствующее событие о готовности заказа к отправке. 
    
    Методы:
    
    `email` — установить значение поля электронной почты;
    
    `phone` — установить значение поля номера телефона;
    
- **Класс `Success`**
    
    Наследуется от класса `Component`. Отвечает за отображение окна об успешной отправке заказа. Отображает общую сумму заказа. При клике на кнопку закрывается модальное окно.
    
    Методы:
    
    `description` — устанавливает значение общей суммы заказа.
    

В основном коммуницаия между классами происходит через события.